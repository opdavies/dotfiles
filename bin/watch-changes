#!/usr/bin/env bash

if [[ "$1" == "" || "$2" == "" ]]; then
  echo "usage: ${0##*/} <file> <command>";
  exit 2;
fi

set -uo pipefail

while true; do
  inotifywait \
    --event modify \
    --event move_self \
    --exclude ".git|simpletest|vendor" \
    --recursive \
    $1 && $2
done
